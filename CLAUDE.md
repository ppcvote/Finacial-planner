# Ultra Advisor å°ˆæ¡ˆè¦æ ¼æ›¸

> **æœ€å¾Œæ›´æ–°ï¼š2026-01-21**
> æœ¬æ–‡æª”æ˜¯çµ¦ AI åŠ©æ‰‹çš„å®Œæ•´äº¤æ¥è¦æ ¼æ›¸ï¼ŒåŒ…å«å°ˆæ¡ˆæ¶æ§‹ã€éƒ¨ç½²æµç¨‹ã€å¸¸è¦‹å•é¡Œç­‰ã€‚

---

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

Ultra Advisor æ˜¯ä¸€å€‹ **SaaS å¹³å°**ï¼Œç‚ºå°ç£è²¡å‹™é¡§å•æä¾› 18 ç¨®æ•¸æ“šè¦–è¦ºåŒ–å·¥å…·ï¼Œå¹«åŠ©é¡§å•å¿«é€Ÿç”¢å‡ºå°ˆæ¥­ææ¡ˆã€‚

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- 18 ç¨®è²¡å‹™è¦–è¦ºåŒ–å·¥å…·ï¼ˆæˆ¿è²¸ã€é€€ä¼‘ã€ç¨…å‹™ç­‰ï¼‰
- æœƒå“¡è¨‚é–±åˆ¶ï¼ˆ5 ç¨®èº«åˆ†çµ„ï¼‰
- é»æ•¸çå‹µç³»çµ±
- SEO éƒ¨è½æ ¼ï¼ˆ34 ç¯‡æ–‡ç« ï¼‰
- LINE å®˜æ–¹å¸³è™Ÿæ•´åˆ

---

## ğŸ”§ æŠ€è¡“æ£§

| å±¤ç´š | æŠ€è¡“ | ç‰ˆæœ¬ |
|------|------|------|
| **å‰ç«¯æ¡†æ¶** | React + TypeScript | 18.2 + 5.2 |
| **æ§‹å»ºå·¥å…·** | Vite | 5.4 |
| **æ¨£å¼** | Tailwind CSS | 3.3 |
| **åœ–è¡¨** | Recharts | 2.10 |
| **å¾Œå° UI** | Ant Design | 5.12 |
| **è³‡æ–™åº«** | Firebase Firestore | 10.7 |
| **èªè­‰** | Firebase Auth | å…§å»º |
| **å¾Œç«¯** | Cloud Functions | Node 20 |
| **éƒ¨ç½²ï¼ˆä¸»è¦ï¼‰** | Vercel | - |
| **éƒ¨ç½²ï¼ˆå‚™ç”¨ï¼‰** | Firebase Hosting | - |

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
C:\Users\User\financial-planner\
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/           # 40+ React å…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ auth/             # ç™»å…¥ã€è¨»å†Šæµç¨‹
â”‚   â”‚   â””â”€â”€ *.tsx             # 18 ç¨®å·¥å…·çµ„ä»¶
â”‚   â”œâ”€â”€ pages/                # é é¢å…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ BlogPage.tsx      # éƒ¨è½æ ¼å¼•æ“ (44KB)
â”‚   â”‚   â”œâ”€â”€ RegisterPage.tsx  # å…¬é–‹è¨»å†Š
â”‚   â”‚   â””â”€â”€ LiffRegister.tsx  # LINE LIFF æ•´åˆ
â”‚   â”œâ”€â”€ hooks/                # è‡ªè¨‚ Hooks
â”‚   â”‚   â”œâ”€â”€ usePoints.ts      # é»æ•¸ç³»çµ±
â”‚   â”‚   â”œâ”€â”€ useMembership.ts  # æœƒå“¡æ¬Šé™
â”‚   â”‚   â””â”€â”€ useStore.ts       # ç‹€æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ data/blog/            # éƒ¨è½æ ¼ç³»çµ±
â”‚   â”‚   â”œâ”€â”€ articles/         # 34 ç¯‡æ–‡ç«  (01-*.ts ~ 34-*.ts)
â”‚   â”‚   â”œâ”€â”€ index.ts          # æ–‡ç« åŒ¯å‡º
â”‚   â”‚   â””â”€â”€ types.ts          # BlogArticle å‹åˆ¥
â”‚   â”œâ”€â”€ constants/tools.ts    # 18 å·¥å…·å®šç¾©
â”‚   â”œâ”€â”€ firebase.ts           # Firebase è¨­å®š
â”‚   â”œâ”€â”€ App.tsx               # ä¸»æ‡‰ç”¨ (37KB)
â”‚   â””â”€â”€ main.tsx              # è·¯ç”±é‚è¼¯
â”œâ”€â”€ api/                      # Vercel Serverless Functions
â”‚   â”œâ”€â”€ blog/[slug].ts        # éƒ¨è½æ ¼ SEO API
â”‚   â””â”€â”€ calculator/index.ts   # è¨ˆç®—æ©Ÿ SEO API
â”œâ”€â”€ admin/                    # Admin å¾Œå°
â”‚   â””â”€â”€ src/pages/            # å¾Œå°é é¢
â”œâ”€â”€ functions/                # Cloud Functions
â”‚   â””â”€â”€ index.js              # 3700+ è¡Œï¼Œ20+ å€‹å‡½æ•¸
â”œâ”€â”€ public/                   # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ og-*.png              # 6 å€‹åˆ†é¡ OG åœ–ç‰‡
â”‚   â””â”€â”€ sitemap.xml           # è‡ªå‹•ç”Ÿæˆ
â”œâ”€â”€ vercel.json               # Vercel éƒ¨ç½²è¨­å®š
â”œâ”€â”€ firebase.json             # Firebase è¨­å®š
â””â”€â”€ firestore.rules           # å®‰å…¨è¦å‰‡
```

---

## ğŸŒ ç¶²å€

| ç’°å¢ƒ | ç¶²å€ |
|------|------|
| å‰ç«¯ä¸»ç«™ | https://ultra-advisor.tw |
| å‰ç«¯ www | https://www.ultra-advisor.tw |
| å¾Œå° | https://admin.ultra-advisor.tw/secret-admin-ultra-2026 |
| LINE å®˜æ–¹å¸³è™Ÿ | https://line.me/R/ti/p/@ultraadvisor |

**Vercel å°ˆæ¡ˆåç¨±ï¼š** `financial-planner`

---

## ğŸ”¥ Firebase è¨­å®š

```javascript
const firebaseConfig = {
  apiKey: "AIzaSyAqS6fhHQVyBNr1LCkCaQPyJ13Rkq7bfHA",
  authDomain: "grbt-f87fa.firebaseapp.com",
  projectId: "grbt-f87fa",
  storageBucket: "grbt-f87fa.firebasestorage.app",
  messagingSenderId: "169700005946",
  appId: "1:169700005946:web:9b0722f31aa9fe7ad13d03",
};
```

---

## ğŸ“Š Firestore è³‡æ–™çµæ§‹

### users/{uid}
```javascript
{
  email: string,
  displayName: string,
  photoURL: string,

  // æœƒå“¡ç³»çµ±
  primaryTierId: "founder" | "paid" | "trial" | "grace" | "expired",
  membershipExpiresAt: Timestamp,

  // é»æ•¸ç³»çµ±
  points: { current: number },
  totalPointsEarned: number,
  totalPointsSpent: number,
  totalPointsExpired: number,

  // æ¨è–¦ç³»çµ±
  referralCode: string,
  referredBy: string,
  referralCount: number,

  // ç™»å…¥è¿½è¹¤
  loginStreak: number,
  lastLoginDate: string,  // YYYY-MM-DD

  createdAt: Timestamp,
  updatedAt: Timestamp,
}
```

### å…¶ä»–é›†åˆ
- `pointsLedger` - é»æ•¸å¸³æœ¬
- `referralCodes` - æ¨è–¦ç¢¼
- `membershipTiers` - æœƒå“¡èº«åˆ†çµ„å®šç¾©
- `missions` - ä»»å‹™ç³»çµ±
- `redemptionOrders` - å…Œæ›è¨‚å–®
- `feedbacks` - ç”¨æˆ¶åé¥‹
- `admins` - ç®¡ç†å“¡åˆ—è¡¨

---

## ğŸ‘¥ æœƒå“¡èº«åˆ†çµ„

| ID | åç¨± | å·¥å…·æ¬Šé™ | èªªæ˜ |
|---|---|---|---|
| `founder` | å‰µå§‹æœƒå“¡ | å…¨éƒ¨ 18 å·¥å…· | æ°¸ä¹…æ¬Šé™ |
| `paid` | ä»˜è²»æœƒå“¡ | å…¨éƒ¨ 18 å·¥å…· | è¨‚é–±ç”¨æˆ¶ |
| `trial` | è©¦ç”¨æœƒå“¡ | 3 å€‹å…è²»å·¥å…· | 7 å¤©è©¦ç”¨ |
| `grace` | å¯¬é™æœŸ | 3 å€‹å…è²»å·¥å…· | åˆ°æœŸå¾Œ 30 å¤© |
| `expired` | å·²éæœŸ | 3 å€‹å…è²»å·¥å…· | éœ€çºŒè¨‚ |

### å…è²»å·¥å…·ï¼ˆæ‰€æœ‰ç”¨æˆ¶å¯ç”¨ï¼‰
- `reservoir` - å¤§å°æ°´åº«å°ˆæ¡ˆ
- `estate` - é‡‘èæˆ¿ç”¢å°ˆæ¡ˆ
- `tax` - ç¨…å‹™å‚³æ‰¿å°ˆæ¡ˆ

---

## ğŸ¯ é»æ•¸è¦å‰‡

| å‹•ä½œ | é»æ•¸ | é™åˆ¶ |
|---|---|---|
| æ¯æ—¥ç™»å…¥ | +5 | æ¯å¤© 1 æ¬¡ |
| ä½¿ç”¨å·¥å…· | +10 | æ¯å¤© 10 æ¬¡ |
| é€£çºŒ 7 å¤© | +50 | æ¯é€± 1 æ¬¡ |
| é€£çºŒ 30 å¤© | +200 | æ¯æœˆ 1 æ¬¡ |
| æ¨è–¦è¨»å†Š | +100 | ç„¡é™ |
| æ¨è–¦ä»˜è²» | +1000 | é›™æ–¹å„å¾— |

---

## â˜ï¸ Cloud Functions

### Callable å‡½æ•¸
| Function | èªªæ˜ |
|---|---|
| `onDailyLogin` | æ¯æ—¥ç™»å…¥çå‹µ |
| `onToolUse` | å·¥å…·ä½¿ç”¨çå‹µ |
| `getUserPointsSummary` | å–å¾—é»æ•¸æ‘˜è¦ |
| `processReferral` | è™•ç†æ¨è–¦ç¢¼ |
| `updateReferralCode` | æ›´æ–°æ¨è–¦ç¢¼ |
| `redeemPoints` | å…Œæ›é»æ•¸ |

### Scheduled å‡½æ•¸
| Function | æ’ç¨‹ | èªªæ˜ |
|---|---|---|
| `checkMembershipExpiry` | æ¯å°æ™‚ | æª¢æŸ¥æœƒå“¡åˆ°æœŸ |
| `expirePoints` | æ¯å¤© | é»æ•¸éæœŸè™•ç† |
| `deductDailyDays` | æ¯å¤© 00:00 | æ‰£é™¤æœƒå“¡å¤©æ•¸ |

### HTTP å‡½æ•¸
| Function | èªªæ˜ |
|---|---|
| `lineWebhook` | LINE Bot Webhook |
| `liffRegister` | LINE LIFF è¨»å†Š |

---

## ğŸ“ éƒ¨è½æ ¼ç³»çµ±

### æ–‡ç« çµæ§‹
```
src/data/blog/
â”œâ”€â”€ articles/           # 34 ç¯‡æ–‡ç«  (01-*.ts ~ 34-*.ts)
â”œâ”€â”€ index.ts           # åŒ¯å‡ºæ‰€æœ‰æ–‡ç« 
â””â”€â”€ types.ts           # BlogArticle å‹åˆ¥
```

### æ–°å¢æ–‡ç« æµç¨‹
1. å»ºç«‹æ–‡ç« æª”æ¡ˆï¼š`src/data/blog/articles/{id}-{slug}.ts`
2. æ›´æ–°åŒ¯å‡ºï¼š`src/data/blog/index.ts`
3. æ›´æ–° APIï¼š`api/blog/[slug].ts` åŠ å…¥ metadata
4. éƒ¨ç½²ï¼š`npx vercel --prod --yes`

### æ–‡ç« åˆ†é¡èˆ‡ OG åœ–ç‰‡
| åˆ†é¡ ID | åˆ†é¡åç¨± | OG åœ–ç‰‡ |
|---------|---------|---------|
| `mortgage` | æˆ¿è²¸çŸ¥è­˜ | og-mortgage.png |
| `retirement` | é€€ä¼‘è¦åŠƒ | og-retirement.png |
| `tax` | ç¨…å‹™å‚³æ‰¿ | og-tax.png |
| `investment` | æŠ•è³‡ç†è²¡ | og-investment.png |
| `tools` | å·¥å…·æ•™å­¸ | og-tools.png |
| `sales` | éŠ·å”®æŠ€å·§ | og-sales.png |

### SEO æ©Ÿåˆ¶
- **Vercel API** (`api/blog/[slug].ts`)ï¼šåµæ¸¬ç¤¾ç¾¤çˆ¬èŸ²ï¼Œè¿”å›æ­£ç¢º meta tags
- **çˆ¬èŸ²æª¢æ¸¬**ï¼šFacebookBotã€LinkedInBotã€WhatsAppã€TelegramBotã€LINE
- **ä¸€èˆ¬ç€è¦½å™¨**ï¼šè¿”å› SPAï¼Œç”± React æ¸²æŸ“

### æ–‡ç« é¢¨æ ¼ï¼ˆ4THINK é¢¨æ ¼ï¼‰
- é–‹é ­ç›´æ¥é»ç ´ç—›é»
- ç”¨æ•…äº‹æˆ–æƒ…å¢ƒå¸¶å…¥
- é‡é»ç”¨ç²—é«”æ¨™è¨»
- å–„ç”¨ã€Œä¸€å¥è©±ç¸½çµã€
- çµå°¾çµ¦è¡Œå‹•å»ºè­°
- ç²¾ç…‰ã€å°‘å»¢è©±

### å…§éƒ¨é€£çµ
æ¯ç¯‡æ–‡ç« çµå°¾åŠ å…¥ã€Œå»¶ä¼¸é–±è®€ã€å€å¡Šï¼š
```html
<div class="bg-slate-800/50 border border-slate-700 rounded-2xl p-6 my-8">
  <h4 class="text-white font-bold mb-4">ğŸ“š å»¶ä¼¸é–±è®€</h4>
  <ul class="text-slate-300 mb-0 space-y-2">
    <li>â†’ <a href="/blog/[slug]" class="text-blue-400 hover:underline">[æ–‡ç« æ¨™é¡Œ]</a></li>
  </ul>
</div>
```

### æ–‡ç« å¯«ä½œè¦ç¯„
- **é¿å…æ¥­å‹™æ„Ÿ**ï¼šæ–‡ç« åˆ†äº«çµ¦å®¢æˆ¶æ™‚ä¸èƒ½æœ‰æ¨éŠ·æ„Ÿ
- **ç¦æ­¢è©å½™**ï¼šã€Œæ¥­å‹™è©±è¡“å»ºè­°ã€ã€ã€Œé‡‘èå¾æ¥­äººå“¡å¿…å‚™ã€
- **å»ºè­°æ›¿ä»£è©**ï¼šã€Œå¯¦éš›çœéŒ¢è©¦ç®—ã€ã€ã€Œå°æé†’ã€ã€ã€Œå¹«ä½ ã€

---

## ğŸ¨ å“ç‰Œè¦ç¯„

### è©èªä¿®æ­£ï¼ˆé¿å…æ•æ„Ÿé‡‘èè©å½™ï¼‰
| âŒ é¿å… | âœ… æ”¹ç”¨ |
|---|---|
| åˆ©å·® | æ”¶ç›Šå·®é¡ |
| å¥—åˆ© | è³‡ç”¢ç´¯ç© |
| æ§“æ¡¿ | ä¿éšœå€æ•¸ |

### è‰²å½©è¦ç¯„
- è² å€¼ä½¿ç”¨ **è—è‰²**ï¼ˆä¸ç”¨ç´…è‰²ï¼Œé¿å…è² é¢è§€æ„Ÿï¼‰
- ä¸»è‰²èª¿ï¼šç´«è‰²æ¼¸å±¤ (`from-purple-600 to-blue-600`)
- èƒŒæ™¯ï¼šæ·±è‰²ç³» (`slate-900`, `slate-800`)

---

## ğŸ–¥ï¸ å¸¸ç”¨æŒ‡ä»¤

```bash
# === å‰ç«¯é–‹ç™¼ ===
cd C:\Users\User\financial-planner
npm run dev

# === å‰ç«¯éƒ¨ç½²ï¼ˆVercelï¼‰===
npm run build
npx vercel --prod --yes

# === Admin å¾Œå° ===
cd admin && npm run dev

# === Cloud Functions ===
firebase deploy --only functions
firebase functions:log

# === Firestore ===
firebase deploy --only firestore:rules
firebase deploy --only firestore:indexes

# === ç¶²åŸŸç®¡ç†ï¼ˆVercelï¼‰===
npx vercel domains ls
npx vercel alias ls
```

---

## ğŸ”‘ é‡è¦ Hooks

### usePoints.ts
```typescript
import { usePoints, pointsApi } from '../hooks/usePoints';

// Hook æ–¹å¼
const { triggerDailyLogin, triggerToolUse } = usePoints();

// API æ–¹å¼ï¼ˆæ¨è–¦ï¼‰
await pointsApi.dailyLogin();
await pointsApi.toolUse('mortgage-calculator');
```

### useMembership.ts
```typescript
import { useMembership } from '../hooks/useMembership';

const { tier, canUseTool, isLoading } = useMembership();

if (canUseTool('golden-vault')) {
  // å¯ä»¥ä½¿ç”¨
}
```

---

## ğŸ› å¸¸è¦‹å•é¡Œæ’æŸ¥

### Firestore æ¬Šé™éŒ¯èª¤
- æª¢æŸ¥ `firestore.rules`
- ç¢ºèªç”¨æˆ¶å·²ç™»å…¥ (`context.auth` å­˜åœ¨)

### Cloud Functions INTERNAL éŒ¯èª¤
- é€šå¸¸æ˜¯ç¼ºå°‘ Firestore è¤‡åˆç´¢å¼•
- Firebase Console â†’ Firestore â†’ ç´¢å¼• å»ºç«‹

### React Error #31
- ã€ŒObjects are not valid as a React childã€
- `{points}` æ‡‰æ”¹ç‚º `{points.current}`

### æœ¬åœ°é–‹ç™¼ EPERM éŒ¯èª¤
```powershell
Remove-Item -Recurse -Force "node_modules\.vite" -ErrorAction SilentlyContinue
npm run dev
```

### www ç¶²åŸŸå•é¡Œ
- å…©å€‹ç¶²åŸŸ (`ultra-advisor.tw` å’Œ `www.ultra-advisor.tw`) éƒ½å·²è¨­å®šåœ¨ Vercel
- éƒ½æŒ‡å‘åŒä¸€å€‹ `financial-planner` å°ˆæ¡ˆ
- ä¸åš www é‡å°å‘ï¼Œå…©å€‹éƒ½èƒ½ç”¨

---

## ğŸš€ éƒ¨ç½²æª¢æŸ¥æ¸…å–®

### å‰ç«¯éƒ¨ç½²
- [ ] `npm run build` ç„¡éŒ¯èª¤
- [ ] `npx vercel --prod --yes` æˆåŠŸ
- [ ] æ¸¬è©¦ https://ultra-advisor.tw æ­£å¸¸

### Cloud Functions éƒ¨ç½²
- [ ] `firebase deploy --only functions` æˆåŠŸ
- [ ] ç’°å¢ƒè®Šæ•¸å·²è¨­å®šï¼ˆLINEã€reCAPTCHAï¼‰
- [ ] `firebase functions:log` ç„¡éŒ¯èª¤

### æ–°å¢æ–‡ç« éƒ¨ç½²
- [ ] æ–‡ç« æª”æ¡ˆå·²å»ºç«‹
- [ ] `index.ts` å·²æ›´æ–°
- [ ] `api/blog/[slug].ts` å·²æ›´æ–° metadata
- [ ] éƒ¨ç½²å¾Œæ¸¬è©¦ OG åœ–ç‰‡é¡¯ç¤º

---

## ğŸ“ é–‹ç™¼æ³¨æ„äº‹é …

1. **ä¿®æ”¹ Cloud Functions å¾Œ**ï¼šè¨˜å¾— `firebase deploy --only functions`
2. **æ–°å¢ Firestore æŸ¥è©¢**ï¼šæª¢æŸ¥æ˜¯å¦éœ€è¦è¤‡åˆç´¢å¼•
3. **é»æ•¸ç›¸é—œ**ï¼š`points` æ˜¯ç‰©ä»¶ `{ current: number }`ï¼Œä¸æ˜¯ç´”æ•¸å­—
4. **éƒ¨è½æ ¼ SEO**ï¼šä¿®æ”¹å¾Œéœ€é‡æ–°éƒ¨ç½² Vercel
5. **ç¶²åŸŸè¨­å®š**ï¼šç”¨ `npx vercel domains` ç®¡ç†ï¼Œä¸è¦ç”¨ alias

---

## ğŸ“‚ é‡è¦æª”æ¡ˆä½ç½®

| åŠŸèƒ½ | æª”æ¡ˆ |
|------|------|
| Firebase è¨­å®š | `src/firebase.ts` |
| å·¥å…·å®šç¾© | `src/constants/tools.ts` |
| æœƒå“¡æ¬Šé™ | `src/hooks/useMembership.ts` |
| é»æ•¸ç³»çµ± | `src/hooks/usePoints.ts` |
| éƒ¨è½æ ¼å¼•æ“ | `src/pages/BlogPage.tsx` |
| éƒ¨è½æ ¼æ–‡ç«  | `src/data/blog/articles/` |
| SEO API | `api/blog/[slug].ts` |
| Cloud Functions | `functions/index.js` |
| å®‰å…¨è¦å‰‡ | `firestore.rules` |
| éƒ¨ç½²è¨­å®š | `vercel.json` |
