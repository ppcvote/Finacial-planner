# ğŸ“‹ Ultra Advisor è¦åŠƒç•Œé¢æ”¹é€ è¦æ ¼æ›¸

> **ç‰ˆæœ¬**ï¼šv1.0  
> **æ—¥æœŸ**ï¼š2026-01-15  
> **ç”¨é€”**ï¼šäº¤ä»˜ Claude Code é€²è¡Œé–‹ç™¼  
> **é ä¼°å·¥æ™‚**ï¼š8-12 å°æ™‚

---

## ğŸ“Œ åŸ·è¡Œæ‘˜è¦

### æ”¹é€ ç›®æ¨™

| é …ç›® | ç¾ç‹€ | ç›®æ¨™ |
|------|------|------|
| å…è²»å·¥å…·æ¨™ç¤º | ã€Œå·²é–å®šã€ï¼ˆè² é¢ï¼‰ | PRO å¾½ç« ï¼ˆæ­£é¢ï¼‰ |
| åˆ†é¡ç”¨èª | ã€Œæ§“æ¡¿èˆ‡å¥—åˆ©ã€ï¼ˆé•è¦ï¼‰ | ã€Œè³‡ç”¢é…ç½®ã€ï¼ˆåˆè¦ï¼‰ |
| å´é‚Šæ¬„ | å›ºå®šå¯¬åº¦ | å¯æ”¶åˆï¼ˆ72px â†” 288pxï¼‰ |
| å­˜æª”æ©Ÿåˆ¶ | ç°¡å–®é¡¯ç¤º | è‡ªå‹•å­˜æª” + ç‹€æ…‹æŒ‡ç¤º |
| PRO å·¥å…·é»æ“Š | ç„¡åæ‡‰/éŒ¯èª¤ | å‡ç´šå¼•å° Modal |

### æ¶‰åŠæª”æ¡ˆ

```
src/
â”œâ”€â”€ App.tsx                    # ä¸»æ‡‰ç”¨ï¼ˆéœ€å¤§å¹…ä¿®æ”¹å´é‚Šæ¬„é‚è¼¯ï¼‰
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ PlannerSidebar.tsx     # ã€æ–°å»ºã€‘ç¨ç«‹å´é‚Šæ¬„å…ƒä»¶
â”‚   â”œâ”€â”€ SaveStatusIndicator.tsx # ã€æ–°å»ºã€‘å­˜æª”ç‹€æ…‹æŒ‡ç¤ºå™¨
â”‚   â”œâ”€â”€ UpgradeModal.tsx       # ã€æ–°å»ºã€‘å‡ç´šå¼•å°å½ˆçª—
â”‚   â””â”€â”€ NavItem.tsx            # ã€æ–°å»ºã€‘å°èˆªé …ç›®å…ƒä»¶
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useAutoSave.ts         # ã€æ–°å»ºã€‘è‡ªå‹•å­˜æª” Hook
â””â”€â”€ constants/
    â””â”€â”€ tools.ts               # ã€æ–°å»ºã€‘å·¥å…·å®šç¾©å¸¸æ•¸
```

---

## ä¸€ã€å·¥å…·èˆ‡æ¬Šé™å®šç¾©

### 1.1 å·¥å…·å¸¸æ•¸å®šç¾©

**æª”æ¡ˆè·¯å¾‘**ï¼š`src/constants/tools.ts`

```typescript
// src/constants/tools.ts
import { 
  LayoutDashboard, ShieldCheck, Activity, History,
  Wallet, Building2, GraduationCap, Rocket,
  Waves, Car, Umbrella, Landmark,
  LucideIcon
} from 'lucide-react';

// å·¥å…·ä»‹é¢å®šç¾©
export interface Tool {
  id: string;
  icon: LucideIcon;
  label: string;
  description: string;      // å·¥å…·ç°¡ä»‹ï¼ˆç”¨æ–¼å‡ç´š Modalï¼‰
  benefits: string[];       // åŠŸèƒ½äº®é»ï¼ˆç”¨æ–¼å‡ç´š Modalï¼‰
  isFree: boolean;          // æ˜¯å¦ç‚ºå…è²»å·¥å…·
}

// å·¥å…·åˆ†é¡ä»‹é¢
export interface ToolCategory {
  id: string;
  title: string;
  color: 'yellow' | 'emerald' | 'blue' | 'purple';  // åˆ†é¡é¡è‰²
  colorClasses: {
    text: string;
    bg: string;
    border: string;
  };
  isFreeCategory: boolean;  // è©²åˆ†é¡æ˜¯å¦å…¨éƒ¨å…è²»
  tools: Tool[];
}

// âš ï¸ ç”¨èªè¦ç¯„ä¿®æ­£ï¼š
// âŒ ã€Œæ§“æ¡¿èˆ‡å¥—åˆ©ã€â†’ âœ… ã€Œè³‡ç”¢é…ç½®ã€
// âŒ ã€Œç¾é‡‘æµé˜²ç¦¦ã€â†’ âœ… ã€Œé¢¨éšªæ§ç®¡ã€ï¼ˆå¯é¸ï¼‰

export const TOOL_CATEGORIES: ToolCategory[] = [
  {
    id: 'diagnosis',
    title: 'è§€å¿µèˆ‡è¨ºæ–·',
    color: 'yellow',
    colorClasses: {
      text: 'text-yellow-400',
      bg: 'bg-yellow-500/10',
      border: 'border-yellow-500/30'
    },
    isFreeCategory: true,
    tools: [
      {
        id: 'free_dashboard',
        icon: LayoutDashboard,
        label: 'è‡ªç”±çµ„åˆæˆ°æƒ…å®¤',
        description: 'è‡ªç”±çµ„åˆå¤šç¨®å·¥å…·ï¼Œæ‰“é€ å®¢è£½åŒ–è«®è©¢å ´æ™¯',
        benefits: ['æ‹–æ‹‰çµ„åˆä»»æ„å·¥å…·', 'å¤šç¨®ç‰ˆé¢é…ç½®', 'ä¸€éµåˆ‡æ›å ´æ™¯'],
        isFree: true
      },
      {
        id: 'golden_safe',
        icon: ShieldCheck,
        label: 'é»ƒé‡‘ä¿éšªç®±ç†è«–',
        description: 'è¦–è¦ºåŒ–å‘ˆç¾ä¿éšªçš„ä¿éšœèˆ‡å„²è“„åŠŸèƒ½',
        benefits: ['ä¿éšœå€æ•¸è©¦ç®—', 'å„²è“„ç´¯ç©æ›²ç·š', 'å°ˆæ¥­åœ–å¡åŒ¯å‡º'],
        isFree: true
      },
      {
        id: 'market_data',
        icon: Activity,
        label: 'å¸‚å ´æ•¸æ“šæˆ°æƒ…',
        description: 'å³æ™‚å¸‚å ´æ•¸æ“šèˆ‡æ¬Šå¨çµ±è¨ˆè³‡æ–™',
        benefits: ['ç™Œç—‡æ™‚é˜æ•¸æ“š', 'é†«ç™‚é€šè†¨è¿½è¹¤', 'å‹ä¿ç ´ç”¢å€’æ•¸'],
        isFree: true
      },
      {
        id: 'fund_machine',
        icon: History,
        label: 'åŸºé‡‘æ™‚å…‰æ©Ÿ',
        description: 'æ­·å²ç¸¾æ•ˆå›æ¸¬ï¼Œé©—è­‰æŠ•è³‡ç­–ç•¥',
        benefits: ['å®šæœŸå®šé¡å›æ¸¬', 'å–®ç­†æŠ•è³‡æ¨¡æ“¬', 'å¤šåŸºé‡‘æ¯”è¼ƒ'],
        isFree: true
      }
    ]
  },
  {
    id: 'wealth',
    title: 'å‰µå¯Œï¼šè³‡ç”¢é…ç½®',  // âœ… å·²ä¿®æ­£ç”¨èª
    color: 'emerald',
    colorClasses: {
      text: 'text-emerald-400',
      bg: 'bg-emerald-500/10',
      border: 'border-emerald-500/30'
    },
    isFreeCategory: false,
    tools: [
      {
        id: 'gift',
        icon: Wallet,
        label: 'ç™¾è¬ç¦®ç‰©å°ˆæ¡ˆ',
        description: 'åˆ©ç”¨ç¨…æ³•ç©ºé–“ï¼Œåˆæ³•ç§»è½‰è³‡ç”¢çµ¦ä¸‹ä¸€ä»£',
        benefits: ['æ¯å¹´ 244 è¬å…ç¨…è´ˆèˆ‡é¡åº¦', '10 å¹´è´ˆèˆ‡ç­–ç•¥è¦åŠƒ', 'å°ˆæ¥­è´ˆèˆ‡å ±å‘ŠåŒ¯å‡º'],
        isFree: false
      },
      {
        id: 'estate',
        icon: Building2,
        label: 'é‡‘èæˆ¿ç”¢å°ˆæ¡ˆ',
        description: 'æˆ¿è²¸å¢è²¸æ´»åŒ–ï¼Œé‡‹æ”¾ä¸å‹•ç”¢åƒ¹å€¼',
        benefits: ['æˆ¿è²¸å¢è²¸è©¦ç®—', 'ç§Ÿé‡‘æŠ•å ±ç‡åˆ†æ', 'è³‡ç”¢æ´»åŒ–ç­–ç•¥'],
        isFree: false
      },
      {
        id: 'student',
        icon: GraduationCap,
        label: 'å­¸è²¸æ´»åŒ–å°ˆæ¡ˆ',
        description: 'å°‡å­¸è²¸è½‰åŒ–ç‚ºäººç”Ÿç¬¬ä¸€ç­†æŠ•è³‡æœ¬é‡‘',
        benefits: ['å­¸è²¸åˆ©å·®åˆ†æ', 'æŠ•è³‡ç´¯ç©è©¦ç®—', 'é‚„æ¬¾ç­–ç•¥è¦åŠƒ'],
        isFree: false
      },
      {
        id: 'super_active',
        icon: Rocket,
        label: 'è¶…ç©æ¥µå­˜éŒ¢æ³•',
        description: 'æ¥µè‡´çš„ç¾é‡‘æµè¦åŠƒï¼ŒåŠ é€Ÿè²¡å¯Œç´¯ç©',
        benefits: ['æ”¶æ”¯é…æ¯”å„ªåŒ–', 'å¼·åˆ¶å„²è“„æ©Ÿåˆ¶', 'ç›®æ¨™é”æˆè¿½è¹¤'],
        isFree: false
      }
    ]
  },
  {
    id: 'protect',
    title: 'å®ˆå¯Œï¼šé¢¨éšªæ§ç®¡',
    color: 'blue',
    colorClasses: {
      text: 'text-blue-400',
      bg: 'bg-blue-500/10',
      border: 'border-blue-500/30'
    },
    isFreeCategory: false,
    tools: [
      {
        id: 'reservoir',
        icon: Waves,
        label: 'å¤§å°æ°´åº«å°ˆæ¡ˆ',
        description: 'é›™å±¤é˜²è­·æ©Ÿåˆ¶ï¼Œç¢ºä¿ç·Šæ€¥é å‚™é‡‘èˆ‡é•·æœŸå„²è“„',
        benefits: ['ç·Šæ€¥é å‚™é‡‘è©¦ç®—', 'å®šæœŸå®šé¡è¦åŠƒ', 'é¢¨éšªç¼ºå£åˆ†æ'],
        isFree: false
      },
      {
        id: 'car',
        icon: Car,
        label: 'äº”å¹´æ›è»Šå°ˆæ¡ˆ',
        description: 'è³‡ç”¢é…ç½®èˆ‡ç”Ÿæ´»å¤¢æƒ³çš„å¹³è¡¡é»',
        benefits: ['è³¼è»Šé ç®—è¦åŠƒ', 'é ­æœŸæ¬¾ç´¯ç©è©¦ç®—', 'è²¸æ¬¾æ–¹æ¡ˆæ¯”è¼ƒ'],
        isFree: false
      },
      {
        id: 'pension',
        icon: Umbrella,
        label: 'é€€ä¼‘ç¼ºå£è©¦ç®—',
        description: 'ç²¾ç®—é€€ä¼‘é‡‘ç¼ºå£ï¼Œæå‰è¦åŠƒç¬¬äºŒäººç”Ÿ',
        benefits: ['æ›¿ä»£ç‡è¨ˆç®—', 'å‹ä¿å‹é€€æ•´åˆ', 'ç¼ºå£è£œè¶³æ–¹æ¡ˆ'],
        isFree: false
      }
    ]
  },
  {
    id: 'legacy',
    title: 'å‚³å¯Œï¼šç¨…å‹™å‚³æ‰¿',
    color: 'purple',
    colorClasses: {
      text: 'text-purple-400',
      bg: 'bg-purple-500/10',
      border: 'border-purple-500/30'
    },
    isFreeCategory: false,
    tools: [
      {
        id: 'tax',
        icon: Landmark,
        label: 'ç¨…å‹™å‚³æ‰¿å°ˆæ¡ˆ',
        description: 'éºç”¢ç¨… & è´ˆèˆ‡ç¨…ç²¾ç®—ï¼Œæœ€ä½³åŒ–å‚³æ‰¿ç­–ç•¥',
        benefits: ['éºç”¢ç¨…è©¦ç®—', 'è´ˆèˆ‡ç¨…è¦åŠƒ', 'æµå‹•æ€§ç¼ºå£æ¸¬è©¦'],
        isFree: false
      }
    ]
  }
];

// å–å¾—æ‰€æœ‰å·¥å…·çš„æ‰å¹³åˆ—è¡¨
export const ALL_TOOLS = TOOL_CATEGORIES.flatMap(cat => cat.tools);

// å–å¾—å…è²»å·¥å…·åˆ—è¡¨
export const FREE_TOOLS = ALL_TOOLS.filter(tool => tool.isFree);

// å–å¾— PRO å·¥å…·åˆ—è¡¨
export const PRO_TOOLS = ALL_TOOLS.filter(tool => !tool.isFree);

// æ ¹æ“š ID å–å¾—å·¥å…·
export const getToolById = (id: string): Tool | undefined => {
  return ALL_TOOLS.find(tool => tool.id === id);
};

// æ ¹æ“š ID å–å¾—å·¥å…·æ‰€å±¬åˆ†é¡
export const getCategoryByToolId = (toolId: string): ToolCategory | undefined => {
  return TOOL_CATEGORIES.find(cat => cat.tools.some(tool => tool.id === toolId));
};
```

### 1.2 æœƒå“¡æ¬Šé™åˆ¤æ–·

```typescript
// src/utils/membership.ts

import { User } from 'firebase/auth';
import { FREE_TOOLS } from '../constants/tools';

export type MembershipStatus = 'trial' | 'active' | 'grace' | 'expired' | 'founder';

export interface MembershipInfo {
  status: MembershipStatus;
  isPro: boolean;              // æ˜¯å¦æœ‰ PRO æ¬Šé™
  isFounder: boolean;          // æ˜¯å¦ç‚ºå‰µå§‹æœƒå“¡
  expiresAt: Date | null;
  daysRemaining: number;
}

/**
 * åˆ¤æ–·ç”¨æˆ¶æ˜¯å¦æœ‰æ¬Šé™ä½¿ç”¨æŸå·¥å…·
 */
export const canAccessTool = (toolId: string, membershipInfo: MembershipInfo): boolean => {
  // å…è²»å·¥å…·ï¼šæ‰€æœ‰äººéƒ½èƒ½ç”¨
  const isFreeToolId = FREE_TOOLS.some(tool => tool.id === toolId);
  if (isFreeToolId) return true;
  
  // PRO å·¥å…·ï¼šéœ€è¦ PRO æ¬Šé™
  return membershipInfo.isPro;
};

/**
 * æ ¹æ“š Firestore ç”¨æˆ¶è³‡æ–™åˆ¤æ–·æœƒå“¡ç‹€æ…‹
 */
export const getMembershipInfo = (userData: any): MembershipInfo => {
  const status = userData?.subscriptionStatus || 'expired';
  const expiresAt = userData?.subscriptionEndDate?.toDate() || 
                    userData?.trialExpiresAt?.toDate() || 
                    null;
  
  const now = new Date();
  const daysRemaining = expiresAt 
    ? Math.ceil((expiresAt.getTime() - now.getTime()) / (1000 * 60 * 60 * 24))
    : 0;
  
  const isPro = ['active', 'trial', 'founder'].includes(status) && daysRemaining > 0;
  const isFounder = userData?.isFounder === true;
  
  return {
    status,
    isPro,
    isFounder,
    expiresAt,
    daysRemaining
  };
};
```

---

## äºŒã€å´é‚Šæ¬„å…ƒä»¶

### 2.1 ä¸»å´é‚Šæ¬„å…ƒä»¶

**æª”æ¡ˆè·¯å¾‘**ï¼š`src/components/PlannerSidebar.tsx`

```typescript
// src/components/PlannerSidebar.tsx
import React, { useState, useEffect } from 'react';
import { 
  ChevronLeft, ChevronRight, PanelLeftClose, PanelLeft,
  FileBarChart, Sparkles
} from 'lucide-react';
import { TOOL_CATEGORIES, Tool, ToolCategory } from '../constants/tools';
import { MembershipInfo, canAccessTool } from '../utils/membership';
import NavItem from './NavItem';
import SaveStatusIndicator, { SaveStatus } from './SaveStatusIndicator';

// ==========================================
// Props ä»‹é¢
// ==========================================
interface Client {
  id: string;
  name: string;
}

interface PlannerSidebarProps {
  client: Client;
  activeTab: string;
  onTabChange: (tabId: string) => void;
  onBack: () => void;
  onGenerateReport: () => void;
  saveStatus: SaveStatus;
  membershipInfo: MembershipInfo;
  onUpgradeClick: (tool: Tool) => void;
}

// ==========================================
// å´é‚Šæ¬„å…ƒä»¶
// ==========================================
const PlannerSidebar: React.FC<PlannerSidebarProps> = ({
  client,
  activeTab,
  onTabChange,
  onBack,
  onGenerateReport,
  saveStatus,
  membershipInfo,
  onUpgradeClick
}) => {
  // æ”¶åˆç‹€æ…‹ï¼ˆå¾ localStorage è®€å–åå¥½ï¼‰
  const [isCollapsed, setIsCollapsed] = useState(() => {
    const saved = localStorage.getItem('planner-sidebar-collapsed');
    return saved ? JSON.parse(saved) : false;
  });

  // å„²å­˜æ”¶åˆç‹€æ…‹åå¥½
  useEffect(() => {
    localStorage.setItem('planner-sidebar-collapsed', JSON.stringify(isCollapsed));
  }, [isCollapsed]);

  // è™•ç†å·¥å…·é»æ“Š
  const handleToolClick = (tool: Tool) => {
    if (canAccessTool(tool.id, membershipInfo)) {
      onTabChange(tool.id);
    } else {
      onUpgradeClick(tool);
    }
  };

  // åˆ‡æ›æ”¶åˆç‹€æ…‹
  const toggleCollapse = () => setIsCollapsed(!isCollapsed);

  return (
    <aside 
      className={`
        bg-slate-900 text-white flex flex-col shadow-2xl z-10 print:hidden
        transition-all duration-300 ease-in-out
        ${isCollapsed ? 'w-16' : 'w-72'}
      `}
    >
      {/* ============================================ */}
      {/* Header å€å¡Š */}
      {/* ============================================ */}
      <div className="p-4 border-b border-slate-800">
        {/* è¿”å›æŒ‰éˆ• + æ”¶åˆæŒ‰éˆ• */}
        <div className="flex items-center justify-between mb-4">
          <button 
            onClick={onBack}
            className={`
              flex items-center gap-2 text-slate-400 hover:text-white 
              hover:bg-slate-800 px-3 py-2 rounded-lg transition-all
              ${isCollapsed ? 'justify-center w-full px-0' : ''}
            `}
            title="è¿”å›æˆ°æƒ…å®¤"
          >
            <ChevronLeft size={18} />
            {!isCollapsed && <span className="text-sm">è¿”å›æˆ°æƒ…å®¤</span>}
          </button>
          
          {!isCollapsed && (
            <button 
              onClick={toggleCollapse}
              className="p-2 hover:bg-slate-800 rounded-lg transition-all text-slate-500 hover:text-white"
              title="æ”¶åˆå´é‚Šæ¬„"
            >
              <PanelLeftClose size={16} />
            </button>
          )}
        </div>
        
        {/* å®¢æˆ¶è³‡è¨Šå¡ç‰‡ */}
        <div className={`flex items-center gap-3 ${isCollapsed ? 'justify-center' : 'px-2'}`}>
          {/* å®¢æˆ¶é ­åƒ */}
          <div 
            className="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center font-bold text-lg shrink-0"
            title={isCollapsed ? client.name : undefined}
          >
            {client.name.charAt(0)}
          </div>
          
          {/* å®¢æˆ¶åç¨±ï¼ˆå±•é–‹æ™‚é¡¯ç¤ºï¼‰ */}
          {!isCollapsed && (
            <div className="flex-1 min-w-0">
              <div className="text-xs text-blue-400 font-bold uppercase">æ­£åœ¨è¦åŠƒ</div>
              <div className="font-bold text-sm truncate">{client.name}</div>
            </div>
          )}
        </div>
        
        {/* å­˜æª”ç‹€æ…‹ */}
        <div className={`mt-3 ${isCollapsed ? 'flex justify-center' : ''}`}>
          <SaveStatusIndicator status={saveStatus} isCollapsed={isCollapsed} />
        </div>
        
        {/* å±•é–‹æŒ‰éˆ•ï¼ˆæ”¶åˆæ™‚é¡¯ç¤ºï¼‰ */}
        {isCollapsed && (
          <button 
            onClick={toggleCollapse}
            className="w-full mt-4 p-2 hover:bg-slate-800 rounded-lg transition-all text-slate-500 hover:text-white flex justify-center"
            title="å±•é–‹å´é‚Šæ¬„"
          >
            <PanelLeft size={16} />
          </button>
        )}
      </div>

      {/* ============================================ */}
      {/* å°èˆªå€å¡Š */}
      {/* ============================================ */}
      <nav className="flex-1 overflow-y-auto p-2 space-y-4 scrollbar-thin scrollbar-thumb-slate-700">
        {TOOL_CATEGORIES.map(category => (
          <CategorySection
            key={category.id}
            category={category}
            activeTab={activeTab}
            isCollapsed={isCollapsed}
            membershipInfo={membershipInfo}
            onToolClick={handleToolClick}
          />
        ))}
      </nav>

      {/* ============================================ */}
      {/* Footer å€å¡Š - ç”Ÿæˆå ±è¡¨æŒ‰éˆ• */}
      {/* ============================================ */}
      <div className="p-4 border-t border-slate-800">
        <button 
          onClick={onGenerateReport}
          className={`
            w-full flex items-center justify-center gap-2 
            bg-gradient-to-r from-blue-600 to-blue-500 
            hover:from-blue-500 hover:to-blue-400
            text-white font-bold rounded-xl transition-all
            shadow-lg shadow-blue-500/25
            ${isCollapsed ? 'p-3' : 'px-4 py-3'}
          `}
          title={isCollapsed ? 'ç”Ÿæˆç­–ç•¥å ±è¡¨' : undefined}
        >
          <FileBarChart size={18} />
          {!isCollapsed && <span>ç”Ÿæˆç­–ç•¥å ±è¡¨</span>}
        </button>
      </div>
    </aside>
  );
};

// ==========================================
// åˆ†é¡å€å¡Šå­å…ƒä»¶
// ==========================================
interface CategorySectionProps {
  category: ToolCategory;
  activeTab: string;
  isCollapsed: boolean;
  membershipInfo: MembershipInfo;
  onToolClick: (tool: Tool) => void;
}

const CategorySection: React.FC<CategorySectionProps> = ({
  category,
  activeTab,
  isCollapsed,
  membershipInfo,
  onToolClick
}) => {
  const isPro = !category.isFreeCategory;
  
  return (
    <div>
      {/* åˆ†é¡æ¨™é¡Œï¼ˆå±•é–‹æ™‚é¡¯ç¤ºï¼‰ */}
      {!isCollapsed && (
        <div className="flex items-center justify-between px-3 py-2">
          <span className={`text-xs font-bold uppercase tracking-wider ${category.colorClasses.text}`}>
            {category.title}
          </span>
          
          {/* PRO å¾½ç«  */}
          {isPro && (
            <span className={`
              text-[10px] font-bold px-2 py-0.5 rounded-full 
              bg-amber-500/15 text-amber-400 border border-amber-500/30
              flex items-center gap-1
            `}>
              <Sparkles size={10} />
              PRO
            </span>
          )}
        </div>
      )}
      
      {/* åˆ†éš”ç·šï¼ˆæ”¶åˆæ™‚é¡¯ç¤ºï¼‰ */}
      {isCollapsed && (
        <div className="h-px bg-slate-800 my-2 mx-2" />
      )}
      
      {/* å·¥å…·åˆ—è¡¨ */}
      <div className="space-y-1">
        {category.tools.map(tool => {
          const hasAccess = canAccessTool(tool.id, membershipInfo);
          const isActive = activeTab === tool.id;
          
          return (
            <NavItem
              key={tool.id}
              icon={tool.icon}
              label={tool.label}
              isActive={isActive}
              isPro={!tool.isFree}
              hasAccess={hasAccess}
              isCollapsed={isCollapsed}
              onClick={() => onToolClick(tool)}
            />
          );
        })}
      </div>
    </div>
  );
};

export default PlannerSidebar;
```

### 2.2 å°èˆªé …ç›®å…ƒä»¶

**æª”æ¡ˆè·¯å¾‘**ï¼š`src/components/NavItem.tsx`

```typescript
// src/components/NavItem.tsx
import React from 'react';
import { LucideIcon, Sparkles } from 'lucide-react';

interface NavItemProps {
  icon: LucideIcon;
  label: string;
  isActive: boolean;
  isPro: boolean;
  hasAccess: boolean;
  isCollapsed: boolean;
  onClick: () => void;
}

const NavItem: React.FC<NavItemProps> = ({
  icon: Icon,
  label,
  isActive,
  isPro,
  hasAccess,
  isCollapsed,
  onClick
}) => {
  // æ ¹æ“šç‹€æ…‹æ±ºå®šæ¨£å¼
  const getStyles = () => {
    if (isActive) {
      return 'bg-blue-600/20 text-blue-400 border border-blue-500/30';
    }
    if (!hasAccess) {
      // PRO å·¥å…·ä½†ç„¡æ¬Šé™ï¼šæ·¡åŒ–ä½†ä¸æ˜¯ã€Œé–å®šã€æ„Ÿ
      return 'text-slate-500 hover:text-slate-300 hover:bg-slate-800/50';
    }
    return 'text-slate-400 hover:text-white hover:bg-slate-800';
  };

  return (
    <button
      onClick={onClick}
      className={`
        w-full flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all
        ${getStyles()}
        ${isCollapsed ? 'justify-center' : ''}
      `}
      title={isCollapsed ? label : undefined}
    >
      {/* åœ–ç¤º */}
      <Icon size={18} className="shrink-0" />
      
      {/* æ¨™ç±¤å’Œ PRO æŒ‡ç¤ºï¼ˆå±•é–‹æ™‚é¡¯ç¤ºï¼‰ */}
      {!isCollapsed && (
        <>
          <span className="flex-1 text-left text-sm font-medium truncate">
            {label}
          </span>
          
          {/* PRO å·¥å…·ç„¡æ¬Šé™æ™‚é¡¯ç¤ºå°æ˜Ÿæ˜Ÿæç¤º */}
          {isPro && !hasAccess && (
            <Sparkles size={14} className="text-amber-400/60" />
          )}
        </>
      )}
    </button>
  );
};

export default NavItem;
```

### 2.3 å­˜æª”ç‹€æ…‹æŒ‡ç¤ºå™¨

**æª”æ¡ˆè·¯å¾‘**ï¼š`src/components/SaveStatusIndicator.tsx`

```typescript
// src/components/SaveStatusIndicator.tsx
import React from 'react';
import { Check, Loader2, AlertCircle, Cloud, CloudOff } from 'lucide-react';

export type SaveStatus = 'saved' | 'saving' | 'unsaved' | 'error' | 'offline';

interface SaveStatusIndicatorProps {
  status: SaveStatus;
  isCollapsed?: boolean;
  lastSavedAt?: Date | null;
}

const SaveStatusIndicator: React.FC<SaveStatusIndicatorProps> = ({
  status,
  isCollapsed = false,
  lastSavedAt
}) => {
  // ç‹€æ…‹é…ç½®
  const config: Record<SaveStatus, {
    icon: React.ReactNode;
    text: string;
    dotColor: string;
    textColor: string;
    bgColor: string;
  }> = {
    saved: {
      icon: <Check size={12} />,
      text: 'å·²åŒæ­¥',
      dotColor: 'bg-emerald-500',
      textColor: 'text-emerald-400',
      bgColor: 'bg-emerald-500/10'
    },
    saving: {
      icon: <Loader2 size={12} className="animate-spin" />,
      text: 'å„²å­˜ä¸­...',
      dotColor: 'bg-blue-500 animate-pulse',
      textColor: 'text-blue-400',
      bgColor: 'bg-blue-500/10'
    },
    unsaved: {
      icon: <AlertCircle size={12} />,
      text: 'æœªå„²å­˜',
      dotColor: 'bg-amber-500',
      textColor: 'text-amber-400',
      bgColor: 'bg-amber-500/10'
    },
    error: {
      icon: <CloudOff size={12} />,
      text: 'å„²å­˜å¤±æ•—',
      dotColor: 'bg-red-500',
      textColor: 'text-red-400',
      bgColor: 'bg-red-500/10'
    },
    offline: {
      icon: <CloudOff size={12} />,
      text: 'é›¢ç·šä¸­',
      dotColor: 'bg-slate-500',
      textColor: 'text-slate-400',
      bgColor: 'bg-slate-500/10'
    }
  };

  const { icon, text, dotColor, textColor, bgColor } = config[status];

  // æ”¶åˆæ¨¡å¼ï¼šåªé¡¯ç¤ºåœ“é»
  if (isCollapsed) {
    return (
      <div 
        className={`w-2.5 h-2.5 rounded-full ${dotColor}`} 
        title={text}
      />
    );
  }

  // å±•é–‹æ¨¡å¼ï¼šå®Œæ•´é¡¯ç¤º
  return (
    <div className={`
      inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full
      ${bgColor} ${textColor}
    `}>
      <span className={`w-2 h-2 rounded-full ${dotColor}`} />
      <span className="text-xs font-medium">{text}</span>
    </div>
  );
};

export default SaveStatusIndicator;
```

---

## ä¸‰ã€è‡ªå‹•å­˜æª”ç³»çµ±

### 3.1 è‡ªå‹•å­˜æª” Hook

**æª”æ¡ˆè·¯å¾‘**ï¼š`src/hooks/useAutoSave.ts`

```typescript
// src/hooks/useAutoSave.ts
import { useState, useEffect, useRef, useCallback } from 'react';
import { doc, updateDoc, serverTimestamp } from 'firebase/firestore';
import { db } from '../firebase';
import { SaveStatus } from '../components/SaveStatusIndicator';

interface UseAutoSaveOptions {
  debounceMs?: number;        // Debounce å»¶é²ï¼ˆæ¯«ç§’ï¼‰
  onSaveSuccess?: () => void; // å„²å­˜æˆåŠŸå›èª¿
  onSaveError?: (error: Error) => void; // å„²å­˜å¤±æ•—å›èª¿
}

interface UseAutoSaveReturn {
  saveStatus: SaveStatus;
  lastSavedAt: Date | null;
  triggerSave: () => void;    // æ‰‹å‹•è§¸ç™¼å„²å­˜
  isSaving: boolean;
}

/**
 * è‡ªå‹•å­˜æª” Hook
 * 
 * @param data - è¦å„²å­˜çš„è³‡æ–™
 * @param userId - ç”¨æˆ¶ ID
 * @param clientId - å®¢æˆ¶ ID
 * @param options - é¸é …é…ç½®
 */
export const useAutoSave = (
  data: Record<string, any> | null,
  userId: string | null,
  clientId: string | null,
  options: UseAutoSaveOptions = {}
): UseAutoSaveReturn => {
  const { 
    debounceMs = 2000,  // é è¨­ 2 ç§’
    onSaveSuccess,
    onSaveError
  } = options;

  const [saveStatus, setSaveStatus] = useState<SaveStatus>('saved');
  const [lastSavedAt, setLastSavedAt] = useState<Date | null>(null);
  
  // ä½¿ç”¨ ref è¿½è¹¤å‰ä¸€æ¬¡è³‡æ–™ï¼Œé¿å…ç„¡è¬‚å„²å­˜
  const prevDataRef = useRef<string | null>(null);
  const saveTimeoutRef = useRef<NodeJS.Timeout | null>(null);
  const isMountedRef = useRef(true);

  // æ¸…ç† timeout
  const clearSaveTimeout = useCallback(() => {
    if (saveTimeoutRef.current) {
      clearTimeout(saveTimeoutRef.current);
      saveTimeoutRef.current = null;
    }
  }, []);

  // åŸ·è¡Œå„²å­˜
  const performSave = useCallback(async (dataToSave: Record<string, any>) => {
    if (!userId || !clientId) return;
    
    setSaveStatus('saving');
    
    try {
      // å„²å­˜åˆ° Firestore
      // è·¯å¾‘: users/{userId}/clients/{clientId}
      const clientRef = doc(db, 'users', userId, 'clients', clientId);
      
      await updateDoc(clientRef, {
        ...dataToSave,
        updatedAt: serverTimestamp()
      });
      
      if (isMountedRef.current) {
        setSaveStatus('saved');
        setLastSavedAt(new Date());
        onSaveSuccess?.();
      }
    } catch (error) {
      console.error('è‡ªå‹•å­˜æª”å¤±æ•—:', error);
      if (isMountedRef.current) {
        setSaveStatus('error');
        onSaveError?.(error as Error);
      }
    }
  }, [userId, clientId, onSaveSuccess, onSaveError]);

  // æ‰‹å‹•è§¸ç™¼å„²å­˜
  const triggerSave = useCallback(() => {
    if (data) {
      clearSaveTimeout();
      performSave(data);
    }
  }, [data, clearSaveTimeout, performSave]);

  // ç›£è½è³‡æ–™è®ŠåŒ–ï¼ŒDebounce è‡ªå‹•å­˜æª”
  useEffect(() => {
    if (!data || !userId || !clientId) return;
    
    // åºåˆ—åŒ–è³‡æ–™ç”¨æ–¼æ¯”è¼ƒ
    const dataString = JSON.stringify(data);
    
    // è³‡æ–™æ²’è®Šå°±ä¸è™•ç†
    if (prevDataRef.current === dataString) return;
    
    prevDataRef.current = dataString;
    setSaveStatus('unsaved');
    
    // æ¸…é™¤èˆŠçš„ timeout
    clearSaveTimeout();
    
    // è¨­å®šæ–°çš„ debounce timeout
    saveTimeoutRef.current = setTimeout(() => {
      performSave(data);
    }, debounceMs);
    
    return clearSaveTimeout;
  }, [data, userId, clientId, debounceMs, clearSaveTimeout, performSave]);

  // å…ƒä»¶å¸è¼‰æ™‚æ¸…ç†
  useEffect(() => {
    isMountedRef.current = true;
    return () => {
      isMountedRef.current = false;
      clearSaveTimeout();
    };
  }, [clearSaveTimeout]);

  // é é¢é—œé–‰å‰å¼·åˆ¶å„²å­˜
  useEffect(() => {
    const handleBeforeUnload = (e: BeforeUnloadEvent) => {
      if (saveStatus === 'unsaved' && data) {
        // å˜—è©¦åŒæ­¥å„²å­˜ï¼ˆä¸ä¿è­‰æˆåŠŸï¼‰
        triggerSave();
        
        // é¡¯ç¤ºé›¢é–‹ç¢ºèª
        e.preventDefault();
        e.returnValue = 'æ‚¨æœ‰æœªå„²å­˜çš„è®Šæ›´ï¼Œç¢ºå®šè¦é›¢é–‹å—ï¼Ÿ';
      }
    };
    
    window.addEventListener('beforeunload', handleBeforeUnload);
    return () => window.removeEventListener('beforeunload', handleBeforeUnload);
  }, [saveStatus, data, triggerSave]);

  return {
    saveStatus,
    lastSavedAt,
    triggerSave,
    isSaving: saveStatus === 'saving'
  };
};

export default useAutoSave;
```

---

## å››ã€å‡ç´šå¼•å° Modal

### 4.1 å‡ç´š Modal å…ƒä»¶

**æª”æ¡ˆè·¯å¾‘**ï¼š`src/components/UpgradeModal.tsx`

```typescript
// src/components/UpgradeModal.tsx
import React, { useEffect } from 'react';
import { X, Sparkles, Check, ArrowRight, Zap } from 'lucide-react';
import { Tool } from '../constants/tools';

interface UpgradeModalProps {
  isOpen: boolean;
  onClose: () => void;
  tool: Tool | null;
  onUpgrade: () => void;
}

const UpgradeModal: React.FC<UpgradeModalProps> = ({
  isOpen,
  onClose,
  tool,
  onUpgrade
}) => {
  // ESC éµé—œé–‰
  useEffect(() => {
    const handleEsc = (e: KeyboardEvent) => {
      if (e.key === 'Escape') onClose();
    };
    
    if (isOpen) {
      document.addEventListener('keydown', handleEsc);
      document.body.style.overflow = 'hidden';
    }
    
    return () => {
      document.removeEventListener('keydown', handleEsc);
      document.body.style.overflow = 'unset';
    };
  }, [isOpen, onClose]);

  if (!isOpen || !tool) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
      {/* èƒŒæ™¯é®ç½© */}
      <div 
        className="absolute inset-0 bg-slate-900/80 backdrop-blur-sm animate-fade-in"
        onClick={onClose}
      />
      
      {/* Modal å…§å®¹ */}
      <div className="relative bg-slate-900 rounded-3xl border border-slate-700 max-w-md w-full overflow-hidden animate-scale-in">
        {/* é ‚éƒ¨è£é£¾æ¼¸å±¤ */}
        <div className="absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-amber-500/10 to-transparent pointer-events-none" />
        
        {/* é—œé–‰æŒ‰éˆ• */}
        <button 
          onClick={onClose}
          className="absolute top-4 right-4 p-2 hover:bg-slate-800 rounded-full text-slate-400 hover:text-white transition-all z-10"
        >
          <X size={20} />
        </button>
        
        {/* å…§å®¹ */}
        <div className="relative p-8 text-center">
          {/* åœ–ç¤º */}
          <div className="w-20 h-20 mx-auto mb-6 rounded-full bg-amber-500/20 border border-amber-500/30 flex items-center justify-center animate-pulse-slow">
            <Sparkles className="text-amber-400" size={36} />
          </div>
          
          {/* æ¨™é¡Œ */}
          <h2 className="text-2xl font-black text-white mb-2">
            è§£é–ã€Œ{tool.label}ã€
          </h2>
          <p className="text-slate-400 mb-6">
            {tool.description}
          </p>
          
          {/* åŠŸèƒ½åˆ—è¡¨ */}
          <div className="bg-slate-800/50 rounded-2xl p-5 mb-6 text-left">
            <p className="text-sm text-slate-400 mb-4 flex items-center gap-2">
              <Zap size={14} className="text-amber-400" />
              æ­¤å·¥å…·å¯å”åŠ©æ‚¨ï¼š
            </p>
            <ul className="space-y-3">
              {tool.benefits.map((benefit, index) => (
                <li key={index} className="flex items-start gap-3">
                  <div className="w-5 h-5 rounded-full bg-emerald-500/20 flex items-center justify-center shrink-0 mt-0.5">
                    <Check size={12} className="text-emerald-400" />
                  </div>
                  <span className="text-white text-sm">{benefit}</span>
                </li>
              ))}
            </ul>
          </div>
          
          {/* åƒ¹æ ¼æç¤º */}
          <div className="bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 mb-6">
            <p className="text-blue-300 text-sm">
              <span className="font-bold">PRO æœƒå“¡</span> å¯ä½¿ç”¨å…¨éƒ¨ 18 ç¨®å°ˆæ¥­å·¥å…·
            </p>
            <p className="text-blue-400/80 text-xs mt-1">
              å¹´ç¹³ NT$6,999ï¼ˆå¹³å‡æ¯å¤©ä¸åˆ° 20 å…ƒï¼‰
            </p>
          </div>
          
          {/* CTA æŒ‰éˆ• */}
          <button 
            onClick={onUpgrade}
            className="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-400 hover:to-amber-500 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-amber-500/25 group"
          >
            <Sparkles size={18} />
            å‡ç´š PRO è§£é–æ‰€æœ‰å·¥å…·
            <ArrowRight size={18} className="group-hover:translate-x-1 transition-transform" />
          </button>
          
          {/* æ¬¡è¦é¸é … */}
          <button 
            onClick={onClose}
            className="mt-4 text-slate-500 hover:text-slate-300 text-sm transition-colors"
          >
            ç¨å¾Œå†èªª
          </button>
        </div>
      </div>
      
      {/* å‹•ç•«æ¨£å¼ */}
      <style>{`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes scale-in {
          from { transform: scale(0.95); opacity: 0; }
          to { transform: scale(1); opacity: 1; }
        }
        @keyframes pulse-slow {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.8; }
        }
        .animate-fade-in {
          animation: fade-in 0.2s ease-out;
        }
        .animate-scale-in {
          animation: scale-in 0.3s ease-out;
        }
        .animate-pulse-slow {
          animation: pulse-slow 2s ease-in-out infinite;
        }
      `}</style>
    </div>
  );
};

export default UpgradeModal;
```

---

## äº”ã€App.tsx æ•´åˆ

### 5.1 ä¿®æ”¹è¦é»

åœ¨ `App.tsx` ä¸­é€²è¡Œä»¥ä¸‹ä¿®æ”¹ï¼š

```typescript
// App.tsx ä¿®æ”¹è¦é»

// 1. å¼•å…¥æ–°å…ƒä»¶å’Œ hooks
import PlannerSidebar from './components/PlannerSidebar';
import UpgradeModal from './components/UpgradeModal';
import { useAutoSave } from './hooks/useAutoSave';
import { Tool } from './constants/tools';
import { getMembershipInfo, MembershipInfo } from './utils/membership';

// 2. æ–°å¢ç‹€æ…‹
const [upgradeModalTool, setUpgradeModalTool] = useState<Tool | null>(null);
const [membershipInfo, setMembershipInfo] = useState<MembershipInfo | null>(null);

// 3. å¾ Firestore è®€å–æœƒå“¡ç‹€æ…‹
useEffect(() => {
  if (user) {
    const unsubscribe = onSnapshot(doc(db, 'users', user.uid), (doc) => {
      if (doc.exists()) {
        setMembershipInfo(getMembershipInfo(doc.data()));
      }
    });
    return () => unsubscribe();
  }
}, [user]);

// 4. æ•´åˆè‡ªå‹•å­˜æª”
const allClientData = {
  goldenSafeData,
  giftData,
  estateData,
  // ... å…¶ä»–å·¥å…·è³‡æ–™
};

const { saveStatus, triggerSave } = useAutoSave(
  currentClient ? allClientData : null,
  user?.uid || null,
  currentClient?.id || null,
  {
    debounceMs: 2000,
    onSaveSuccess: () => console.log('è‡ªå‹•å­˜æª”æˆåŠŸ'),
    onSaveError: (err) => console.error('è‡ªå‹•å­˜æª”å¤±æ•—', err)
  }
);

// 5. å‡ç´šå¼•å°è™•ç†
const handleUpgradeClick = (tool: Tool) => {
  setUpgradeModalTool(tool);
};

const handleUpgradeConfirm = () => {
  // å°å‘ä»˜æ¬¾é é¢
  window.open('https://portaly.cc/ultraadvisor/plans', '_blank');
  setUpgradeModalTool(null);
};

// 6. æ›¿æ›å´é‚Šæ¬„ JSX
// ç§»é™¤åŸæœ¬çš„ <aside> å€å¡Šï¼Œæ”¹ç”¨ï¼š
<PlannerSidebar
  client={currentClient}
  activeTab={activeTab}
  onTabChange={setActiveTab}
  onBack={() => setCurrentClient(null)}
  onGenerateReport={() => setIsReportOpen(true)}
  saveStatus={saveStatus}
  membershipInfo={membershipInfo || { status: 'expired', isPro: false, isFounder: false, expiresAt: null, daysRemaining: 0 }}
  onUpgradeClick={handleUpgradeClick}
/>

// 7. åŠ å…¥å‡ç´š Modal
<UpgradeModal
  isOpen={!!upgradeModalTool}
  onClose={() => setUpgradeModalTool(null)}
  tool={upgradeModalTool}
  onUpgrade={handleUpgradeConfirm}
/>
```

### 5.2 å®Œæ•´çš„ App.tsx å´é‚Šæ¬„æ›¿æ›å€å¡Š

```tsx
// æ›¿æ›åŸæœ¬çš„æ¡Œé¢ç‰ˆå´é‚Šæ¬„
{currentClient && (
  <>
    {/* æ¡Œé¢ç‰ˆï¼šä½¿ç”¨æ–°å´é‚Šæ¬„å…ƒä»¶ */}
    <div className="hidden md:block">
      <PlannerSidebar
        client={currentClient}
        activeTab={activeTab}
        onTabChange={setActiveTab}
        onBack={() => setCurrentClient(null)}
        onGenerateReport={() => setIsReportOpen(true)}
        saveStatus={saveStatus}
        membershipInfo={membershipInfo || defaultMembershipInfo}
        onUpgradeClick={handleUpgradeClick}
      />
    </div>
    
    {/* æ‰‹æ©Ÿç‰ˆå´é‚Šæ¬„ä¿æŒåŸæœ¬é‚è¼¯ï¼Œä½†å¥—ç”¨æ–°çš„ NavItem */}
    {isMobileMenuOpen && (
      <MobileSidebar
        client={currentClient}
        activeTab={activeTab}
        onTabChange={(tab) => { setActiveTab(tab); setIsMobileMenuOpen(false); }}
        onBack={() => { setCurrentClient(null); setIsMobileMenuOpen(false); }}
        onClose={() => setIsMobileMenuOpen(false)}
        membershipInfo={membershipInfo || defaultMembershipInfo}
        onUpgradeClick={handleUpgradeClick}
      />
    )}
    
    {/* å‡ç´šå¼•å° Modal */}
    <UpgradeModal
      isOpen={!!upgradeModalTool}
      onClose={() => setUpgradeModalTool(null)}
      tool={upgradeModalTool}
      onUpgrade={handleUpgradeConfirm}
    />
  </>
)}
```

---

## å…­ã€æ¨£å¼è£œå……

### 6.1 Tailwind é…ç½®è£œå……

ç¢ºä¿ `tailwind.config.js` åŒ…å«ä»¥ä¸‹æ“´å……ï¼š

```javascript
// tailwind.config.js
module.exports = {
  content: ['./src/**/*.{js,jsx,ts,tsx}'],
  theme: {
    extend: {
      colors: {
        'strategy-blue': { light: '#4DA3FF', DEFAULT: '#2E6BFF' },
        'signal-red': { light: '#FF6A6A', DEFAULT: '#FF3A3A' },
        'ultra-purple': { start: '#8A5CFF', mid: '#CE4DFF', center: '#E8E0FF' },
        'amber-gold': '#F59E0B',
        'war-room': '#050b14',
      },
      animation: {
        'fade-in': 'fade-in 0.2s ease-out',
        'scale-in': 'scale-in 0.3s ease-out',
        'pulse-slow': 'pulse-slow 2s ease-in-out infinite',
      },
      keyframes: {
        'fade-in': {
          from: { opacity: '0' },
          to: { opacity: '1' },
        },
        'scale-in': {
          from: { transform: 'scale(0.95)', opacity: '0' },
          to: { transform: 'scale(1)', opacity: '1' },
        },
        'pulse-slow': {
          '0%, 100%': { opacity: '1' },
          '50%': { opacity: '0.8' },
        },
      },
    },
  },
  plugins: [
    require('tailwind-scrollbar')({ nocompatible: true }),
  ],
};
```

### 6.2 å®‰è£ä¾è³´

```bash
npm install tailwind-scrollbar
```

---

## ä¸ƒã€æ¸¬è©¦æª¢æ ¸æ¸…å–®

### 7.1 åŠŸèƒ½æ¸¬è©¦

- [ ] **å´é‚Šæ¬„æ”¶åˆ/å±•é–‹**
  - [ ] é»æ“Šæ”¶åˆæŒ‰éˆ•ï¼Œå´é‚Šæ¬„å¯¬åº¦å¾ 288px è®Šç‚º 64px
  - [ ] é»æ“Šå±•é–‹æŒ‰éˆ•ï¼Œå´é‚Šæ¬„æ¢å¾© 288px
  - [ ] æ”¶åˆç‹€æ…‹æ­£ç¢ºå„²å­˜åˆ° localStorage
  - [ ] é‡æ–°æ•´ç†é é¢å¾Œç¶­æŒæ”¶åˆç‹€æ…‹

- [ ] **è‡ªå‹•å­˜æª”**
  - [ ] ä¿®æ”¹è³‡æ–™å¾Œ 2 ç§’ï¼Œç‹€æ…‹è®Šç‚ºã€Œå„²å­˜ä¸­ã€
  - [ ] å„²å­˜æˆåŠŸå¾Œï¼Œç‹€æ…‹è®Šç‚ºã€Œå·²åŒæ­¥ã€
  - [ ] æŒçºŒä¿®æ”¹æ™‚ï¼Œæ­£ç¢º debounceï¼ˆä¸æœƒé€£çºŒå„²å­˜ï¼‰
  - [ ] å„²å­˜å¤±æ•—æ™‚ï¼Œç‹€æ…‹è®Šç‚ºã€Œå„²å­˜å¤±æ•—ã€

- [ ] **PRO å·¥å…·æ¬Šé™**
  - [ ] å…è²»æœƒå“¡é»æ“Š PRO å·¥å…·ï¼Œå½ˆå‡ºå‡ç´š Modal
  - [ ] PRO æœƒå“¡é»æ“Š PRO å·¥å…·ï¼Œæ­£å¸¸åˆ‡æ›
  - [ ] å…è²»å·¥å…·æ‰€æœ‰äººéƒ½èƒ½æ­£å¸¸ä½¿ç”¨

- [ ] **å‡ç´š Modal**
  - [ ] ESC éµå¯é—œé–‰
  - [ ] é»æ“ŠèƒŒæ™¯å¯é—œé–‰
  - [ ] é»æ“Šã€Œå‡ç´šã€æŒ‰éˆ•å°å‘ä»˜æ¬¾é é¢
  - [ ] é»æ“Šã€Œç¨å¾Œå†èªªã€é—œé–‰ Modal

### 7.2 éŸ¿æ‡‰å¼æ¸¬è©¦

- [ ] **æ¡Œé¢ç‰ˆï¼ˆâ‰¥768pxï¼‰**
  - [ ] å´é‚Šæ¬„æ­£å¸¸é¡¯ç¤º
  - [ ] æ”¶åˆåŠŸèƒ½æ­£å¸¸
  
- [ ] **è¡Œå‹•ç‰ˆï¼ˆ<768pxï¼‰**
  - [ ] å´é‚Šæ¬„éš±è—ï¼Œæ¼¢å ¡é¸å–®æ­£å¸¸
  - [ ] æ‰‹æ©Ÿå´é‚Šæ¬„å¥—ç”¨æ–°æ¨£å¼

### 7.3 é‚Šç•Œæƒ…æ³

- [ ] ç”¨æˆ¶æœªç™»å…¥æ™‚ï¼Œä¸è§¸ç™¼è‡ªå‹•å­˜æª”
- [ ] ç„¡å®¢æˆ¶é¸æ“‡æ™‚ï¼Œä¸é¡¯ç¤ºå´é‚Šæ¬„
- [ ] ç¶²è·¯æ–·ç·šæ™‚ï¼Œæ­£ç¢ºé¡¯ç¤ºã€Œé›¢ç·šã€ç‹€æ…‹

---

## å…«ã€æª”æ¡ˆæ¸…å–®ç¸½è¦½

```
src/
â”œâ”€â”€ constants/
â”‚   â””â”€â”€ tools.ts              # ã€æ–°å»ºã€‘å·¥å…·å®šç¾©å¸¸æ•¸
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ membership.ts         # ã€æ–°å»ºã€‘æœƒå“¡æ¬Šé™åˆ¤æ–·
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useAutoSave.ts        # ã€æ–°å»ºã€‘è‡ªå‹•å­˜æª” Hook
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ PlannerSidebar.tsx    # ã€æ–°å»ºã€‘å´é‚Šæ¬„ä¸»å…ƒä»¶
â”‚   â”œâ”€â”€ NavItem.tsx           # ã€æ–°å»ºã€‘å°èˆªé …ç›®å…ƒä»¶
â”‚   â”œâ”€â”€ SaveStatusIndicator.tsx # ã€æ–°å»ºã€‘å­˜æª”ç‹€æ…‹æŒ‡ç¤ºå™¨
â”‚   â””â”€â”€ UpgradeModal.tsx      # ã€æ–°å»ºã€‘å‡ç´šå¼•å° Modal
â”œâ”€â”€ App.tsx                   # ã€ä¿®æ”¹ã€‘æ•´åˆæ–°å…ƒä»¶
â””â”€â”€ tailwind.config.js        # ã€ä¿®æ”¹ã€‘æ–°å¢å‹•ç•«é…ç½®
```

---

## ä¹ã€æ³¨æ„äº‹é …

### 9.1 ç”¨èªè¦ç¯„ï¼ˆå‹™å¿…éµå®ˆï¼‰

| âŒ ç¦æ­¢ä½¿ç”¨ | âœ… æ­£ç¢ºç”¨èª |
|-------------|-------------|
| æ§“æ¡¿ | ä¿éšœå€æ•¸ |
| å¥—åˆ© | è³‡ç”¢ç´¯ç© |
| åˆ©å·® | æ”¶ç›Šå·®é¡ |
| éœ€è‡ªè¡Œè² æ“” | åªéœ€è² æ“” |
| å·²é–å®š | PRO |

### 9.2 è¨­è¨ˆåŸå‰‡

1. **PRO ä¸æ˜¯æ‡²ç½°**ï¼šPRO å¾½ç« è¦è®“äººã€Œæƒ³è¦ã€è€Œéã€Œè¢«æ’æ–¥ã€
2. **è‡ªå‹•å­˜æª”è¦ç„¡æ„Ÿ**ï¼šç”¨æˆ¶ä¸éœ€è¦æ‰‹å‹•é»å„²å­˜
3. **æ”¶åˆè¦è¨˜æ†¶**ï¼šç”¨æˆ¶åå¥½æ‡‰è©²è¢«å°Šé‡
4. **å‡ç´šè¦æ­£å‘**ï¼šå±•ç¤ºåƒ¹å€¼è€Œéå¼·èª¿é™åˆ¶

### 9.3 å“ç‰Œè‰²å½©é€ŸæŸ¥

```
è—è‰²ä¸»è‰²: #4DA3FF â†’ #2E6BFF
ç¥ç€é‡‘ï¼ˆPROï¼‰: #F59E0B
ç¿¡ç¿ ç¶ ï¼ˆæˆåŠŸï¼‰: #10B981
æˆ°æƒ…é»‘: #050b14
```

---

**æ­¤è¦æ ¼æ›¸åŒ…å«å®Œæ•´ç¨‹å¼ç¢¼ï¼Œå¯ç›´æ¥äº¤ä»˜ Claude Code é€²è¡Œé–‹ç™¼ã€‚**